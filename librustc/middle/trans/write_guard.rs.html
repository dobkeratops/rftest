<head><link href="../../../css/shCore.css" rel="stylesheet" type="text/css"/><link href="../../../css/shThemeDefault.css" rel="stylesheet" type="text/css"/><link href="../../../css/sourcestyle.css" rel="stylesheet" type="text/css"/></head><body><div><maintext><div><fileblock><br/>&nbsp;&nbsp;&nbsp;&nbsp;<a href="./../../../index.html">(index&lt;-&nbsp;)</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="./../../../">&nbsp;&nbsp;&nbsp;&nbsp;./</a><c0><a href="./../../../librustc/">librustc</a></c0><c1>/</c1><c0><a href="./../../../librustc/middle/">middle</a></c0><c1>/</c1><c0><a href="./../../../librustc/middle/trans/">trans</a></c0><c1>/</c1><c0><a href="./../../../librustc/middle/trans/write_guard.rs.html">write_guard.rs</a></c0><br/><br/><c40>&nbsp;&nbsp;&nbsp;&nbsp;git&nbsp;branch:&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;master&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8801d89&nbsp;auto&nbsp;merge&nbsp;of&nbsp;#13399&nbsp;:&nbsp;SimonSapin/rust/patch-8,&nbsp;r=cmr<br/></c40><c40>&nbsp;&nbsp;&nbsp;&nbsp;modified:&nbsp;&nbsp;&nbsp;&nbsp;Wed&nbsp;Mar&nbsp;26&nbsp;11:50:03&nbsp;2014<br/></c40></fileblock></div><ln>&nbsp;&nbsp;1</ln><a id="1">&nbsp;</a>&nbsp;<c40>//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Rust&nbsp;Project&nbsp;Developers.&nbsp;See&nbsp;the&nbsp;COPYRIGHT
</c40><br/><ln>&nbsp;&nbsp;2</ln><a id="2">&nbsp;</a>&nbsp;<c40>//&nbsp;file&nbsp;at&nbsp;the&nbsp;top-level&nbsp;directory&nbsp;of&nbsp;this&nbsp;distribution&nbsp;and&nbsp;at
</c40><br/><ln>&nbsp;&nbsp;3</ln><a id="3">&nbsp;</a>&nbsp;<c40>//&nbsp;http://rust-lang.org/COPYRIGHT.
</c40><br/><ln>&nbsp;&nbsp;4</ln><a id="4">&nbsp;</a>&nbsp;<c40>//
</c40><br/><ln>&nbsp;&nbsp;5</ln><a id="5">&nbsp;</a>&nbsp;<c40>//&nbsp;Licensed&nbsp;under&nbsp;the&nbsp;Apache&nbsp;License,&nbsp;Version&nbsp;2.0&nbsp;&lt;LICENSE-APACHE&nbsp;or
</c40><br/><ln>&nbsp;&nbsp;6</ln><a id="6">&nbsp;</a>&nbsp;<c40>//&nbsp;http://www.apache.org/licenses/LICENSE-2.0&gt;&nbsp;or&nbsp;the&nbsp;MIT&nbsp;license
</c40><br/><ln>&nbsp;&nbsp;7</ln><a id="7">&nbsp;</a>&nbsp;<c40>//&nbsp;&lt;LICENSE-MIT&nbsp;or&nbsp;http://opensource.org/licenses/MIT&gt;,&nbsp;at&nbsp;your
</c40><br/><ln>&nbsp;&nbsp;8</ln><a id="8">&nbsp;</a>&nbsp;<c40>//&nbsp;option.&nbsp;This&nbsp;file&nbsp;may&nbsp;not&nbsp;be&nbsp;copied,&nbsp;modified,&nbsp;or&nbsp;distributed
</c40><br/><ln>&nbsp;&nbsp;9</ln><a id="9">&nbsp;</a>&nbsp;<c40>//&nbsp;except&nbsp;according&nbsp;to&nbsp;those&nbsp;terms.
</c40><br/><ln>&nbsp;10</ln><a id="10">&nbsp;</a>&nbsp;<c0>
</c0><br/><ln>&nbsp;11</ln><a id="11">&nbsp;</a>&nbsp;<c40>//!&nbsp;Logic&nbsp;relating&nbsp;to&nbsp;rooting&nbsp;and&nbsp;write&nbsp;guards&nbsp;for&nbsp;managed&nbsp;values.
</c40><br/><ln>&nbsp;12</ln><a id="12">&nbsp;</a>&nbsp;<c40>//!&nbsp;This&nbsp;code&nbsp;is&nbsp;primarily&nbsp;for&nbsp;use&nbsp;by&nbsp;datum;
</c40><br/><ln>&nbsp;13</ln><a id="13">&nbsp;</a>&nbsp;<c40>//!&nbsp;it&nbsp;exists&nbsp;in&nbsp;its&nbsp;own&nbsp;module&nbsp;both&nbsp;to&nbsp;keep&nbsp;datum.rs&nbsp;bite-sized
</c40><br/><ln>&nbsp;14</ln><a id="14">&nbsp;</a>&nbsp;<c40>//!&nbsp;and&nbsp;for&nbsp;each&nbsp;in&nbsp;debugging&nbsp;(e.g.,&nbsp;so&nbsp;you&nbsp;can&nbsp;use
</c40><br/><ln>&nbsp;15</ln><a id="15">&nbsp;</a>&nbsp;<c40>//!&nbsp;`RUST_LOG=rustc::middle::trans::write_guard`).
</c40><br/><ln>&nbsp;16</ln><a id="16">&nbsp;</a>&nbsp;<c0>
</c0><br/><ln>&nbsp;17</ln><a id="17">&nbsp;</a>&nbsp;<c0>
</c0><br/><ln>&nbsp;18</ln><a id="18">&nbsp;</a>&nbsp;<c21>use</c21><c0>&nbsp;middle::borrowck::</c0><c3>{</c3><c0>RootInfo</c0><c3>,</c3><c0>&nbsp;root_map_key</c0><c3>};</c3><c0>
</c0><br/><ln>&nbsp;19</ln><a id="19">&nbsp;</a>&nbsp;<c21>use</c21><c0>&nbsp;middle::trans::cleanup</c0><c3>;</c3><c0>
</c0><br/><ln>&nbsp;20</ln><a id="20">&nbsp;</a>&nbsp;<c21>use</c21><c0>&nbsp;middle::trans::common::*</c0><c3>;</c3><c0>
</c0><br/><ln>&nbsp;21</ln><a id="21">&nbsp;</a>&nbsp;<c21>use</c21><c0>&nbsp;middle::trans::datum::*</c0><c3>;</c3><c0>
</c0><br/><ln>&nbsp;22</ln><a id="22">&nbsp;</a>&nbsp;<c21>use</c21><c0>&nbsp;syntax::codemap::Span</c0><c3>;</c3><c0>
</c0><br/><ln>&nbsp;23</ln><a id="23">&nbsp;</a>&nbsp;<c21>use</c21><c0>&nbsp;syntax::ast</c0><c3>;</c3><c0>
</c0><br/><ln>&nbsp;24</ln><a id="24">&nbsp;</a><a id="n10473">&nbsp;</a><c0>
</c0><br/><ln>&nbsp;25</ln><a id="25">&nbsp;</a><a id="n10479"><a id="n10478"><a id="n10476"><a id="n10480"><a id="n10506">&nbsp;</a></a></a></a></a><c21>pub</c21><c1><a href="#line24_col1_refs">&nbsp;</a></c1><c30>fn</c30><c30><a href="#line24_col1_refs">&nbsp;root_and_write_guard</a></c30><c5><a href="#line24_col1_refs">&lt;'a</a></c5><c5>,</c5><c5><a href="#line24_col1_refs">&nbsp;K:</a></c5><c5><a href="../../../librustc/middle/trans/datum.rs.html#187">KindOps</a></c5><c5><a href="#line24_col1_refs">&gt;</a></c5><c4>(</c4><c20><a href="#line25_col43_refs">datum</a></c20><c1><a href="#line24_col1_refs">:&nbsp;</a></c1><c8><a href="#line24_col1_refs">&amp;</a></c8><c8><a href="../../../librustc/middle/trans/datum.rs.html#38">Datum&lt;</a></c8><c8><a href="crate_id=0 node_id=10505">K</a></c8><c8><a href="../../../librustc/middle/trans/datum.rs.html#38">&gt;</a></c8><c3>,</c3><c1><a href="#line24_col1_refs">
</a></c1><br/><ln>&nbsp;26</ln><a id="26">&nbsp;</a><a id="n10487"><a id="n10485"><a id="n10486">&nbsp;</a></a></a><c1><a href="#line24_col1_refs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></c1><c20><a href="#line26_col43_refs">bcx</a></c20><c1><a href="#line24_col1_refs">:&nbsp;</a></c1><c8><a href="#line24_col1_refs">&amp;'a&nbsp;</a></c8><c8><a href="../../../librustc/middle/trans/common.rs.html#393">Block&lt;'a&gt;</a></c8><c3>,</c3><c1><a href="#line24_col1_refs">
</a></c1><br/><ln>&nbsp;27</ln><a id="27">&nbsp;</a><a id="n10490"><a id="n10491">&nbsp;</a></a><c1><a href="#line24_col1_refs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></c1><c20><a href="#line27_col43_refs">span</a></c20><c1><a href="#line24_col1_refs">:&nbsp;</a></c1><c8><a href="../../../libsyntax/codemap.rs.html#n10775">Span</a></c8><c3>,</c3><c1><a href="#line24_col1_refs">
</a></c1><br/><ln>&nbsp;28</ln><a id="28">&nbsp;</a><a id="n10495"><a id="n10494">&nbsp;</a></a><c1><a href="#line24_col1_refs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></c1><c20><a href="#line28_col43_refs">expr_id</a></c20><c1><a href="#line24_col1_refs">:&nbsp;</a></c1><c8><a href="../../../libsyntax/ast.rs.html#n18300">ast::NodeId</a></c8><c3>,</c3><c1><a href="#line24_col1_refs">
</a></c1><br/><ln>&nbsp;29</ln><a id="29">&nbsp;</a><a id="n10503"><a id="n10504"><a id="n10625"><a id="n10499"><a id="n10498">&nbsp;</a></a></a></a></a><c1><a href="#line24_col1_refs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></c1><c20><a href="#line29_col43_refs">derefs</a></c20><c1><a href="#line24_col1_refs">:&nbsp;</a></c1><c8><a href="#line24_col1_refs">uint</a></c8><c4>)</c4><c1><a href="#line24_col1_refs">&nbsp;</a></c1><c4>-&gt;</c4><c1><a href="#line24_col1_refs">&nbsp;</a></c1><c8><a href="#line24_col1_refs">&amp;'a&nbsp;</a></c8><c8><a href="../../../librustc/middle/trans/common.rs.html#393">Block&lt;'a&gt;</a></c8><c1><a href="#line24_col1_refs">&nbsp;</a></c1><c3>{</c3><c22><a href="#line24_col1_refs">
</a></c22><br/><ln>&nbsp;30</ln><a id="30">&nbsp;</a><a id="n10510"><a id="n10511"><a id="n10513"><a id="n10512"><a id="n10509"><a id="n10514"><a id="n10508">&nbsp;</a></a></a></a></a></a></a><c22><a href="#line24_col1_refs">&nbsp;&nbsp;&nbsp;&nbsp;</a></c22><c21>let</c21><c22><a href="#line24_col1_refs">&nbsp;</a></c22><c20><a href="#line30_col8_refs">key</a></c20><c16><a href="#line24_col1_refs">&nbsp;=&nbsp;</a></c16><c1><a href="../../../librustc/middle/borrowck/mod.rs.html#208">root_map_key&nbsp;</a></c1><c3>{</c3><c1><a href="../../../librustc/middle/borrowck/mod.rs.html#208">&nbsp;id:&nbsp;</a></c1><c26><a href="../../../librustc/middle/trans/write_guard.rs.html#28">expr_id</a></c26><c3>,</c3><c1><a href="../../../librustc/middle/borrowck/mod.rs.html#208">&nbsp;derefs:&nbsp;</a></c1><c26><a href="../../../librustc/middle/trans/write_guard.rs.html#29">derefs</a></c26><c1><a href="../../../librustc/middle/borrowck/mod.rs.html#208">&nbsp;</a></c1><c3>};</c3><c22><a href="#line24_col1_refs">
</a></c22><br/><ln>&nbsp;31</ln><a id="31">&nbsp;</a><a id="n10567"><a id="n10569"><a id="n10573"><a id="n10578"><a id="n10582"><a id="n10563"><a id="n10593"><a id="n10595"><a id="n10560"><a id="n10562"><a id="n10559"><a id="n10566"><a id="n10589"><a id="n10576"><a id="n10550"><a id="n10590"><a id="n10574"><a id="n10579"><a id="n10551"><a id="n10555"><a id="n10586"><a id="n10577"><a id="n10584"><a id="n10571"><a id="n10552"><a id="n10561"><a id="n10591"><a id="n10558"><a id="n10594"><a id="n10580"><a id="n10587"><a id="n10596"><a id="n10557"><a id="n10548"><a id="n10564"><a id="n10565"><a id="n10568"><a id="n10581"><a id="n10583"><a id="n10570"><a id="n10575"><a id="n10585"><a id="n10572"><a id="n10588"><a id="n10610"><a id="n10592"><a id="n10556"><a id="n10547"><a id="n10549"><a id="n10613"><a id="n10597">&nbsp;</a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a><c22><a href="#line24_col1_refs">&nbsp;&nbsp;&nbsp;&nbsp;debug!</a></c22><c4>(</c4><c22><a href="../../../librustc/middle/trans/write_guard.rs.html#31">"write_guard::root_and_write_guard</a></c22><c4>(</c4><c22><a href="../../../librustc/middle/trans/write_guard.rs.html#31">key=</a></c22><c3>{</c3><c22><a href="../../../librustc/middle/trans/write_guard.rs.html#31">:?</a></c22><c3>}</c3><c4>)</c4><c22><a href="../../../librustc/middle/trans/write_guard.rs.html#31">"</a></c22><c3>,</c3><c22><a href="#line24_col1_refs">&nbsp;</a></c22><c26><a href="../../../librustc/middle/trans/write_guard.rs.html#30">key</a></c26><c4>)</c4><c3>;</c3><c22><a href="#line24_col1_refs">
</a></c22><br/><ln>&nbsp;32</ln><a id="32">&nbsp;</a>&nbsp;<c22><a href="#line24_col1_refs">
</a></c22><br/><ln>&nbsp;33</ln><a id="33">&nbsp;</a>&nbsp;<c22><a href="#line24_col1_refs">&nbsp;&nbsp;&nbsp;&nbsp;</a></c22><c40>//&nbsp;root&nbsp;the&nbsp;autoderef'd&nbsp;value,&nbsp;if&nbsp;necessary:
</c40><br/><ln>&nbsp;34</ln><a id="34">&nbsp;</a>&nbsp;<c22><a href="#line24_col1_refs">&nbsp;&nbsp;&nbsp;&nbsp;</a></c22><c40>//
</c40><br/><ln>&nbsp;35</ln><a id="35">&nbsp;</a>&nbsp;<c22><a href="#line24_col1_refs">&nbsp;&nbsp;&nbsp;&nbsp;</a></c22><c40>//&nbsp;(Note:&nbsp;root'd&nbsp;values&nbsp;are&nbsp;always&nbsp;boxes)
</c40><br/><ln>&nbsp;36</ln><a id="36">&nbsp;</a><a id="n10622"><a id="n10621"><a id="n10619"><a id="n10624"><a id="n10623"><a id="n10620">&nbsp;</a></a></a></a></a></a><c22><a href="#line24_col1_refs">&nbsp;&nbsp;&nbsp;&nbsp;</a></c22><c21>let</c21><c22><a href="#line24_col1_refs">&nbsp;</a></c22><c20><a href="#line36_col8_refs">ccx</a></c20><c13><a href="#line24_col1_refs">&nbsp;=&nbsp;</a></c13><c26><a href="../../../librustc/middle/trans/write_guard.rs.html#26">bcx</a></c26><c10><a href="../../../librustc/middle/trans/common.rs.html#433">.ccx</a></c10><c4>()</c4><c3>;</c3><c22><a href="#line24_col1_refs">
</a></c22><br/><ln>&nbsp;37</ln><a id="37">&nbsp;</a><a id="n10628"><a id="n10626"><a id="n10629"><a id="n10632"><a id="n10630"><a id="n10627"><a id="n10631"><a id="n10645">&nbsp;</a></a></a></a></a></a></a></a><c22><a href="#line24_col1_refs">&nbsp;&nbsp;&nbsp;&nbsp;</a></c22><c21>match</c21><c21><a href="#line24_col1_refs">&nbsp;</a></c21><c26><a href="../../../librustc/middle/trans/write_guard.rs.html#36">ccx</a></c26><c24><a href="../../../librustc/middle/trans/context.rs.html#100">.maps</a></c24><c24><a href="../../../librustc/middle/astencode.rs.html#56">.root_map</a></c24><c10><a href="../../../libstd/cell.rs.html#n106898">.borrow</a></c10><c4>()</c4><c10><a href="../../../libcollections/hashmap.rs.html#n13548">.find</a></c10><c4>(</c4><c5><a href="../../../libcollections/hashmap.rs.html#n13548">&amp;</a></c5><c26><a href="../../../librustc/middle/trans/write_guard.rs.html#30">key</a></c26><c4>)</c4><c21><a href="#line24_col1_refs">&nbsp;</a></c21><c3>{</c3><c21><a href="#line24_col1_refs">
</a></c21><br/><ln>&nbsp;38</ln><a id="38">&nbsp;</a><a id="n10634"><a id="n10633">&nbsp;</a></a><c21><a href="#line24_col1_refs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></c21><c20><a href="../../../libstd/option.rs.html#n103652">None</a></c20><c21><a href="#line24_col1_refs">&nbsp;</a></c21><c4>=&gt;</c4><c21><a href="#line24_col1_refs">&nbsp;</a></c21><c26><a href="../../../librustc/middle/trans/write_guard.rs.html#26">bcx</a></c26><c3>,</c3><c21><a href="#line24_col1_refs">
</a></c21><br/><ln>&nbsp;39</ln><a id="39">&nbsp;</a><a id="n10639"><a id="n10638"><a id="n10635"><a id="n10643"><a id="n10644"><a id="n10640"><a id="n10637"><a id="n10636"><a id="n10641"><a id="n10642">&nbsp;</a></a></a></a></a></a></a></a></a></a><c21><a href="#line24_col1_refs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></c21><c20><a href="../../../libstd/option.rs.html#n103656">Some</a></c20><c4>(</c4><c20><a href="../../../libstd/option.rs.html#n103656">&amp;</a></c20><c20><a href="#line39_col14_refs">root_info</a></c20><c4>)</c4><c21><a href="#line24_col1_refs">&nbsp;</a></c21><c4>=&gt;</c4><c21><a href="#line24_col1_refs">&nbsp;</a></c21><c26><a href="../../../librustc/middle/trans/write_guard.rs.html#42">root</a></c26><c4>(</c4><c26><a href="../../../librustc/middle/trans/write_guard.rs.html#25">datum</a></c26><c3>,</c3><c27><a href="#line24_col1_refs">&nbsp;</a></c27><c26><a href="../../../librustc/middle/trans/write_guard.rs.html#26">bcx</a></c26><c3>,</c3><c27><a href="#line24_col1_refs">&nbsp;</a></c27><c26><a href="../../../librustc/middle/trans/write_guard.rs.html#27">span</a></c26><c3>,</c3><c27><a href="#line24_col1_refs">&nbsp;</a></c27><c26><a href="../../../librustc/middle/trans/write_guard.rs.html#30">key</a></c26><c3>,</c3><c27><a href="#line24_col1_refs">&nbsp;</a></c27><c26><a href="../../../librustc/middle/trans/write_guard.rs.html#39">root_info</a></c26><c4>)</c4><c21><a href="#line24_col1_refs">
</a></c21><br/><ln>&nbsp;40</ln><a id="40">&nbsp;</a>&nbsp;<c21><a href="#line24_col1_refs">&nbsp;&nbsp;&nbsp;&nbsp;</a></c21><c3>}</c3><c22><a href="#line24_col1_refs">
</a></c22><br/><ln>&nbsp;41</ln><a id="41">&nbsp;</a>&nbsp;<c3>}</c3><c0>
</c0><br/><ln>&nbsp;42</ln><a id="42">&nbsp;</a><a id="n10646">&nbsp;</a><c0>
</c0><br/><ln>&nbsp;43</ln><a id="43">&nbsp;</a><a id="n10679"><a id="n10652"><a id="n10653"><a id="n10651"><a id="n10649">&nbsp;</a></a></a></a></a><c30>fn</c30><c30><a href="#line42_col1_refs">&nbsp;root</a></c30><c5><a href="#line42_col1_refs">&lt;'a</a></c5><c5>,</c5><c5><a href="#line42_col1_refs">&nbsp;K:</a></c5><c5><a href="../../../librustc/middle/trans/datum.rs.html#187">KindOps</a></c5><c5><a href="#line42_col1_refs">&gt;</a></c5><c4>(</c4><c20><a href="#line43_col23_refs">datum</a></c20><c1><a href="#line42_col1_refs">:&nbsp;</a></c1><c8><a href="#line42_col1_refs">&amp;</a></c8><c8><a href="../../../librustc/middle/trans/datum.rs.html#38">Datum&lt;</a></c8><c8><a href="crate_id=0 node_id=10678">K</a></c8><c8><a href="../../../librustc/middle/trans/datum.rs.html#38">&gt;</a></c8><c3>,</c3><c1><a href="#line42_col1_refs">
</a></c1><br/><ln>&nbsp;44</ln><a id="44">&nbsp;</a><a id="n10659"><a id="n10658"><a id="n10660">&nbsp;</a></a></a><c1><a href="#line42_col1_refs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></c1><c20><a href="#line44_col23_refs">bcx</a></c20><c1><a href="#line42_col1_refs">:&nbsp;</a></c1><c8><a href="#line42_col1_refs">&amp;'a&nbsp;</a></c8><c8><a href="../../../librustc/middle/trans/common.rs.html#393">Block&lt;'a&gt;</a></c8><c3>,</c3><c1><a href="#line42_col1_refs">
</a></c1><br/><ln>&nbsp;45</ln><a id="45">&nbsp;</a><a id="n10664"><a id="n10663">&nbsp;</a></a><c1><a href="#line42_col1_refs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></c1><c20><a href="#line42_col1_refs">_span</a></c20><c1><a href="#line42_col1_refs">:&nbsp;</a></c1><c8><a href="../../../libsyntax/codemap.rs.html#n10775">Span</a></c8><c3>,</c3><c1><a href="#line42_col1_refs">
</a></c1><br/><ln>&nbsp;46</ln><a id="46">&nbsp;</a><a id="n10667"><a id="n10668">&nbsp;</a></a><c1><a href="#line42_col1_refs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></c1><c20><a href="#line46_col23_refs">root_key</a></c20><c1><a href="#line42_col1_refs">:&nbsp;</a></c1><c8><a href="../../../librustc/middle/borrowck/mod.rs.html#208">root_map_key</a></c8><c3>,</c3><c1><a href="#line42_col1_refs">
</a></c1><br/><ln>&nbsp;47</ln><a id="47">&nbsp;</a><a id="n10672"><a id="n10830"><a id="n10676"><a id="n10677"><a id="n10671">&nbsp;</a></a></a></a></a><c1><a href="#line42_col1_refs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></c1><c20><a href="#line47_col23_refs">root_info</a></c20><c1><a href="#line42_col1_refs">:&nbsp;</a></c1><c8><a href="../../../librustc/middle/borrowck/mod.rs.html#376">RootInfo</a></c8><c4>)</c4><c1><a href="#line42_col1_refs">&nbsp;</a></c1><c4>-&gt;</c4><c1><a href="#line42_col1_refs">&nbsp;</a></c1><c8><a href="#line42_col1_refs">&amp;'a&nbsp;</a></c8><c8><a href="../../../librustc/middle/trans/common.rs.html#393">Block&lt;'a&gt;</a></c8><c1><a href="#line42_col1_refs">&nbsp;</a></c1><c3>{</c3><c22><a href="#line42_col1_refs">
</a></c22><br/><ln>&nbsp;48</ln><a id="48">&nbsp;</a>&nbsp;<c22><a href="#line42_col1_refs">&nbsp;&nbsp;&nbsp;&nbsp;</a></c22><c40>//!&nbsp;In&nbsp;some&nbsp;cases,&nbsp;borrowck&nbsp;will&nbsp;decide&nbsp;that&nbsp;an&nbsp;@T&nbsp;value&nbsp;must&nbsp;be
</c40><br/><ln>&nbsp;49</ln><a id="49">&nbsp;</a>&nbsp;<c22><a href="#line42_col1_refs">&nbsp;&nbsp;&nbsp;&nbsp;</a></c22><c40>//!&nbsp;rooted&nbsp;for&nbsp;the&nbsp;program&nbsp;to&nbsp;be&nbsp;safe.&nbsp;&nbsp;In&nbsp;that&nbsp;case,&nbsp;we&nbsp;will&nbsp;call
</c40><br/><ln>&nbsp;50</ln><a id="50">&nbsp;</a>&nbsp;<c22><a href="#line42_col1_refs">&nbsp;&nbsp;&nbsp;&nbsp;</a></c22><c40>//!&nbsp;this&nbsp;function,&nbsp;which&nbsp;will&nbsp;stash&nbsp;a&nbsp;copy&nbsp;away&nbsp;until&nbsp;we&nbsp;exit&nbsp;the
</c40><br/><ln>&nbsp;51</ln><a id="51">&nbsp;</a>&nbsp;<c22><a href="#line42_col1_refs">&nbsp;&nbsp;&nbsp;&nbsp;</a></c22><c40>//!&nbsp;scope&nbsp;`scope_id`.
</c40><br/><ln>&nbsp;52</ln><a id="52">&nbsp;</a>&nbsp;<c22><a href="#line42_col1_refs">
</a></c22><br/><ln>&nbsp;53</ln><a id="53">&nbsp;</a><a id="n10782"><a id="n10734"><a id="n10733"><a id="n10746"><a id="n10731"><a id="n10768"><a id="n10754"><a id="n10740"><a id="n10770"><a id="n10745"><a id="n10758"><a id="n10766"><a id="n10800"><a id="n10764"><a id="n10821"><a id="n10732"><a id="n10771"><a id="n10750"><a id="n10780"><a id="n10742"><a id="n10802"><a id="n10727"><a id="n10752"><a id="n10748"><a id="n10760"><a id="n10767"><a id="n10806"><a id="n10808"><a id="n10726"><a id="n10738"><a id="n10753"><a id="n10798"><a id="n10781"><a id="n10756"><a id="n10797"><a id="n10779"><a id="n10796"><a id="n10774"><a id="n10741"><a id="n10743"><a id="n10759"><a id="n10778"><a id="n10769"><a id="n10747"><a id="n10776"><a id="n10775"><a id="n10730"><a id="n10824"><a id="n10739"><a id="n10805"><a id="n10772"><a id="n10736"><a id="n10735"><a id="n10803"><a id="n10751"><a id="n10749"><a id="n10765"><a id="n10795"><a id="n10804"><a id="n10807"><a id="n10777"><a id="n10762"><a id="n10773"><a id="n10744"><a id="n10722"><a id="n10799"><a id="n10757"><a id="n10755"><a id="n10763"><a id="n10761"><a id="n10737"><a id="n10801">&nbsp;</a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a><c22><a href="#line42_col1_refs">&nbsp;&nbsp;&nbsp;&nbsp;debug!</a></c22><c4>(</c4><c22><a href="../../../libstd/fmt/rt.rs.html#n164656">"write_guard::root</a></c22><c4>(</c4><c22><a href="../../../libstd/fmt/rt.rs.html#n164656">root_key=</a></c22><c3>{</c3><c22><a href="../../../libstd/fmt/rt.rs.html#n164656">:?</a></c22><c3>},</c3><c22><a href="../../../libstd/fmt/rt.rs.html#n164656">&nbsp;root_info=</a></c22><c3>{</c3><c22><a href="../../../libstd/fmt/rt.rs.html#n164656">:?</a></c22><c3>},</c3><c22><a href="../../../libstd/fmt/rt.rs.html#n164656">&nbsp;datum=</a></c22><c3>{</c3><c22><a href="../../../libstd/fmt/rt.rs.html#n164656">:?</a></c22><c3>}</c3><c4>)</c4><c22><a href="../../../libstd/fmt/rt.rs.html#n164656">"</a></c22><c3>,</c3><c22><a href="#line42_col1_refs">
</a></c22><br/><ln>&nbsp;54</ln><a id="54">&nbsp;</a><a id="n10784"><a id="n10786"><a id="n10791"><a id="n10721"><a id="n10718"><a id="n10790"><a id="n10713"><a id="n10724"><a id="n10725"><a id="n10787"><a id="n10794"><a id="n10720"><a id="n10789"><a id="n10788"><a id="n10793"><a id="n10785"><a id="n10719"><a id="n10715"><a id="n10714"><a id="n10792"><a id="n10717"><a id="n10723"><a id="n10783"><a id="n10716">&nbsp;</a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a><c22><a href="#line42_col1_refs">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></c22><c26><a href="../../../libstd/fmt/mod.rs.html#n166625">root_key</a></c26><c3>,</c3><c22><a href="#line42_col1_refs">&nbsp;</a></c22><c5><a href="../../../librustc/middle/trans/write_guard.rs.html#47">root_info</a></c5><c3>,</c3><c22><a href="#line42_col1_refs">&nbsp;</a></c22><c26><a href="../../../librustc/middle/trans/write_guard.rs.html#43">datum</a></c26><c26><a href="../../../libstd/fmt/mod.rs.html#n165216">.to_str</a></c26><c4>(</c4><c26><a href="../../../librustc/middle/trans/write_guard.rs.html#44">bcx</a></c26><c10><a href="../../../librustc/middle/trans/common.rs.html#433">.ccx</a></c10><c4>()))</c4><c3>;</c3><c22><a href="#line42_col1_refs">
</a></c22><br/><ln>&nbsp;55</ln><a id="55">&nbsp;</a>&nbsp;<c22><a href="#line42_col1_refs">
</a></c22><br/><ln>&nbsp;56</ln><a id="56">&nbsp;</a>&nbsp;<c22><a href="#line42_col1_refs">&nbsp;&nbsp;&nbsp;&nbsp;</a></c22><c40>//&nbsp;Root&nbsp;the&nbsp;datum.&nbsp;Note&nbsp;that&nbsp;we&nbsp;must&nbsp;zero&nbsp;this&nbsp;value,
</c40><br/><ln>&nbsp;57</ln><a id="57">&nbsp;</a>&nbsp;<c22><a href="#line42_col1_refs">&nbsp;&nbsp;&nbsp;&nbsp;</a></c22><c40>//&nbsp;because&nbsp;sometimes&nbsp;we&nbsp;root&nbsp;on&nbsp;one&nbsp;path&nbsp;but&nbsp;not&nbsp;another.
</c40><br/><ln>&nbsp;58</ln><a id="58">&nbsp;</a>&nbsp;<c22><a href="#line42_col1_refs">&nbsp;&nbsp;&nbsp;&nbsp;</a></c22><c40>//&nbsp;See&nbsp;e.g.&nbsp;#4904.
</c40><br/><ln>&nbsp;59</ln><a id="59">&nbsp;</a><a id="n10831"><a id="n10860"><a id="n10859">&nbsp;</a></a></a><c22><a href="#line42_col1_refs">&nbsp;&nbsp;&nbsp;&nbsp;</a></c22><c26><a href="../../../librustc/middle/trans/datum.rs.html#113">lvalue_scratch_datum</a></c26><c4>(</c4><c27><a href="../../../librustc/middle/trans/datum.rs.html#52">
</a></c27><br/><ln>&nbsp;60</ln><a id="60">&nbsp;</a><a id="n10836"><a id="n10832"><a id="n10835"><a id="n10834"><a id="n10833">&nbsp;</a></a></a></a></a><c27><a href="../../../librustc/middle/trans/datum.rs.html#52">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></c27><c26><a href="../../../librustc/middle/trans/write_guard.rs.html#44">bcx</a></c26><c3>,</c3><c27><a href="../../../librustc/middle/trans/datum.rs.html#52">&nbsp;</a></c27><c26><a href="../../../librustc/middle/trans/write_guard.rs.html#43">datum</a></c26><c24><a href="../../../librustc/middle/trans/datum.rs.html#45">.ty</a></c24><c3>,</c3><c27><a href="../../../librustc/middle/trans/datum.rs.html#52">&nbsp;</a></c27><c12><a href="../../../librustc/middle/trans/datum.rs.html#52">"__write_guard"</a></c12><c3>,</c3><c27><a href="../../../librustc/middle/trans/datum.rs.html#52">&nbsp;</a></c27><c12><a href="#line42_col1_refs">true</a></c12><c3>,</c3><c27><a href="../../../librustc/middle/trans/datum.rs.html#52">
</a></c27><br/><ln>&nbsp;61</ln><a id="61">&nbsp;</a><a id="n10839"><a id="n10841"><a id="n10837"><a id="n10838"><a id="n10840">&nbsp;</a></a></a></a></a><c27><a href="../../../librustc/middle/trans/datum.rs.html#52">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></c27><c26><a href="../../../librustc/middle/trans/cleanup.rs.html#76">cleanup::AstScope</a></c26><c4>(</c4><c26><a href="../../../librustc/middle/trans/write_guard.rs.html#47">root_info</a></c26><c24><a href="../../../librustc/middle/borrowck/mod.rs.html#378">.scope</a></c24><c4>)</c4><c3>,</c3><c27><a href="../../../librustc/middle/trans/datum.rs.html#52">&nbsp;</a></c27><c4>()</c4><c3>,</c3><c27><a href="../../../librustc/middle/trans/datum.rs.html#52">
</a></c27><br/><ln>&nbsp;62</ln><a id="62">&nbsp;</a><a id="n10845"><a id="n10853"><a id="n10857"><a id="n10844"><a id="n10858"><a id="n10850"><a id="n10851"><a id="n10854"><a id="n10843"><a id="n10852"><a id="n10855"><a id="n10848"><a id="n10856"><a id="n10847">&nbsp;</a></a></a></a></a></a></a></a></a></a></a></a></a></a><c27><a href="../../../librustc/middle/trans/datum.rs.html#52">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></c27><c1><a href="#line42_col1_refs">|</a></c1><c4>()</c4><c3>,</c3><c1><a href="#line42_col1_refs">&nbsp;</a></c1><c20><a href="#line62_col13_refs">bcx</a></c20><c3>,</c3><c1><a href="#line42_col1_refs">&nbsp;</a></c1><c20><a href="#line62_col18_refs">llval</a></c20><c8><a href="#line42_col1_refs">|</a></c8><c1><a href="#line42_col1_refs">&nbsp;</a></c1><c8><a href="../../../librustc/middle/trans/write_guard.rs.html#43">datum</a></c8><c10><a href="../../../librustc/middle/trans/datum.rs.html#608">.shallow_copy_and_take</a></c10><c4>(</c4><c26><a href="../../../librustc/middle/trans/write_guard.rs.html#62">bcx</a></c26><c3>,</c3><c10><a href="../../../librustc/middle/trans/datum.rs.html#608">&nbsp;</a></c10><c26><a href="../../../librustc/middle/trans/write_guard.rs.html#62">llval</a></c26><c4>))</c4><c24><a href="../../../librustc/middle/trans/datum.rs.html#52">.bcx</a></c24><c22><a href="#line42_col1_refs">
</a></c22><br/><ln>&nbsp;63</ln><a id="63">&nbsp;</a>&nbsp;<c3>}</c3><c0>
</c0><br/><div class="refblock"><br/><a id="line42_col1_refs"><c43>librustc/middle/trans/write_guard.rs:42:1-42:1&nbsp;-fn-&nbsp;definition:<br/></c43><a href="#42"><pr>fn&nbsp;root&lt;'a,&nbsp;K:KindOps&gt;(datum:&nbsp;&amp;Datum&lt;K&gt;,
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bcx:&nbsp;&amp;'a&nbsp;Block&lt;'a&gt;,
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_span:&nbsp;Span,
<br/></pr></a></a><c43>references:-</c43><br/><a href="../../../librustc/middle/trans/write_guard.rs.html#39"><c40>38:&nbsp;</c40>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None&nbsp;=&gt;&nbsp;bcx,
<br/><c40>39:&nbsp;</c40>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Some(&amp;root_info)&nbsp;=&gt;&nbsp;root(datum,&nbsp;bcx,&nbsp;span,&nbsp;key,&nbsp;root_info)
<br/><c40>40:&nbsp;</c40>&nbsp;&nbsp;&nbsp;&nbsp;}
<br/></a><br/><br/><a id="line24_col1_refs"><c43>librustc/middle/trans/write_guard.rs:24:1-24:1&nbsp;-fn-&nbsp;definition:<br/></c43><a href="#24"><pr>pub&nbsp;fn&nbsp;root_and_write_guard&lt;'a,&nbsp;K:KindOps&gt;(datum:&nbsp;&amp;Datum&lt;K&gt;,
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bcx:&nbsp;&amp;'a&nbsp;Block&lt;'a&gt;,
<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;span:&nbsp;Span,
<br/></pr></a></a><c43>references:-</c43><br/><a href="../../../librustc/middle/trans/expr.rs.html"><c40>librustc/middle/trans/expr.rs:<br/></c40></a><a href="../../../librustc/middle/trans/expr.rs.html#1701"><c40>1700:&nbsp;</c40>&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;ccx&nbsp;=&nbsp;bcx.ccx();
<br/><c40>1701:&nbsp;</c40>&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;bcx&nbsp;=&nbsp;write_guard::root_and_write_guard(&amp;datum,&nbsp;bcx,&nbsp;expr.span,
<br/><c40>1702:&nbsp;</c40>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expr.id,&nbsp;derefs);
<br/></a><br/></div></maintext></div></body>